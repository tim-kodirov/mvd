(function(a){a.fn.dnCalendar=function(e){var i=a(this);var p={};var f=new Date();var h=null;var r=new Date();var c=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];var d=false;Array.prototype.move=function(v,t){while(v<0){v+=this.length}while(t<0){t+=this.length}if(t>=this.length){var u=t-this.length;while((u--)+1){this.push(undefined)}}this.splice(t,0,this.splice(v,1)[0]);return this};var l=function(){for(var t=0;t<c.length;t++){if(c[t]==p.startWeek.toLowerCase()){return t}}return 0};var n=function(v,x){var w=new Date(v,x-1,1);var t=new Date(v,x,0);var u=w.getDay()+t.getDate();return Math.ceil(u/7)};var m=function(E,F){var t=[],u=new Date(F,E,1),w=new Date(F,E+1,0),D=w.getDate(),B=l();var G=new Date(F,E,0);var v=G.getDate()-u.getDay();var z=new Date(F,E+1,1);var A=z.getDate();var y=1;while(y<=D){var C=0;var x=[];while(C<7){if(t.length==0){if(C>=u.getDay()){x.push(y);y++}else{v++;x.push(v)}}else{if(y<=D){x.push(y);y++}else{x.push(A++)}}C++}t.push(x)}return t};var o=function(x,Q,C){var A=l();var K=new Date(C,Q,0);var M=K.getDate();var D=new Date(C,Q+1,0).getDate();function B(T,V){var U=false;for(var S=0;S<T.length;S++){if(T[S]==V){U=true;break}}return U}if(A>0){var O=[];var t=x.length;for(var H=0;H<t;H++){var u=[];if(H==0&&O.length==0){if(x[H][0]==1){var y=M-(7-A-1);while(y<=M){u.push(y);y++}for(var G=0;G<x[H].length;G++){if(u.length<x[H].length){var R=x[H][G];var z=B(u,R);if(!z){u.push(R)}}}}else{for(var G=0;G<x[H].length;G++){if(u.length<x[H].length){if(typeof x[H][G+A]!=="undefined"){u.push(x[H][G+A])}else{if(typeof x[H+1]!=="undefined"){for(var F=0;F<x[H+1].length;F++){if(u.length<x[H].length){var R=x[H+1][F];var z=B(u,R);if(!z){u.push(R)}}}}}}}}}else{for(var v=H;v>=0;v--){var E=false;for(var G=0;G<x[v].length;G++){var N=O.length-1;var J=O[N].length-1;if(O[N][J]==x[v][G]){E=true}if(E==true){if(typeof x[v][G+A]!=="undefined"){if(u.length<x[v].length){var R=x[v][G+A];var z=B(u,R);if(!z){u.push(x[v][G+A])}}}else{if(typeof x[v+1]!=="undefined"){for(var F=0;F<x[v+1].length;F++){if(u.length<x[v].length){var R=x[v+1][F];var z=B(u,R);if(!z){u.push(R)}}}}}}}}}O.push(u)}var E=false;for(var H=0;H<O.length;H++){for(var G=0;G<O[H].length;G++){if(O[H][G]==D){E=true;break}}if(E==true){break}}var N=O.length-1;if(E==false){var J=O[N].length-1;var w=O[N][J];var u=[];while(w<D){w++;u.push(w)}if(u.length<7){var L=7-u.length;var P=1;while(P<=L){u.push(P);P++}}O.push(u)}else{var J=O[N].length-1;var w=O[N][J];var I=7-(J+1);if(w>7){w=1}else{w=w+1}while(I>0){O[N].push(w);w++;I--}console.log("newArrCol",J);console.log("colLeft",I)}return O}return x};var g=function(){var ao=f.getMonth();var ay=f.getDate();var ah=f.getFullYear();var ap=m(ao,ah);for(var av=0;av<ap.length;av++){var I="";for(var ar=0;ar<ap[av].length;ar++){I+=ap[av][ar]+" "}console.log(av+" => "+I)}console.log("--------------------------------");ap=o(ap,ao,ah);for(var av=0;av<ap.length;av++){var I="";for(var ar=0;ar<ap[av].length;ar++){I+=ap[av][ar]+" "}console.log(av+" => "+I)}var U=p.monthNames[ao];if(p.monthUseShortName==true){U=p.monthNamesShort[ao]}var al=a("<div id='dncalendar-header' class='dncalendar-header'></div>");al.append("<h2>"+U+" "+ah+"</h2>");var D=false;var z=null;if(typeof p.minDate!=="undefined"){var aC=p.minDate.split("-");z=new Date(aC[0],aC[1]-1,aC[2]);if(z.getFullYear()>=ah){if(z.getMonth()>=ao){D=true}}}var X=false;var H=null;if(typeof p.maxDate!=="undefined"){var Q=p.maxDate.split("-");H=new Date(Q[0],Q[1]-1,Q[2]);if(H.getFullYear()<=ah){if(H.getMonth()<=ao){X=true}}}var ab=a("<div id='dncalendar-links' class='dncalendar-links'></div>");var ak=a("<div id='dncalendar-prev-month' class='dncalendar-prev-month'></div>");var J=a("<div id='dncalendar-next-month' class='dncalendar-next-month'></div>");if(D){ak.addClass("dncalendar-inactive");ak.removeAttr("id")}if(X){J.addClass("dncalendar-inactive");J.removeAttr("id")}ab.append(ak);ab.append(J);al.append(ab);var L=a("<div id='dncalendar-body' class='dncalendar-body'></div>");var aa=a("<table></table>");var Y=p.dayNames;if(p.dayUseShortName==true){Y=p.dayNamesShort}var at=l();if(d==false){var aB=null;var ad=0;for(var av=0;av<Y.length;av++){if(av>=at){if(aB==null){aB=av}Y.move(aB,ad);aB++;ad++}}d=true}console.log("week after",Y);var K=(at==0)?0:7-at;var M=6-at;var x=a("<thead></thead>");var v=a("<tr></tr>");var ax=Y.length;for(var av=0;av<ax;av++){v.append("<td "+((av==K||av==M)?'class="holiday"':"")+">"+Y[av]+"</td>")}x.append(v);var C=a("<tbody></tbody>");var G=n(ah,ao+1);console.log("totalWeeks",G);var O=7;var B=1;var u=new Date(ah,ao,1);var az=new Date(ah,ao+1,0);var Z=new Date(ah,ao,0);var ac=Z.getDate()-u.getDay()+1;var A=new Date(ah,ao+1,1);var an=A.getDate();var V=0;if(z!=null){V=z.getDate()}var af=0;if(H!=null){af=H.getDate()}var F="today";var au="default date";if(typeof p.dataTitles!=="undefined"){if(typeof p.dataTitles.defaultDate!=="undefined"){au=p.dataTitles.defaultDate}if(typeof p.dataTitles.today!=="undefined"){F=p.dataTitles.today}}var K=(at==0)?0:7-at;var M=(at==0)?7-1:7-(at+1);console.log("sundayIndex",K);console.log("saturdayIndex",M);var P=ap.length;for(var av=0;av<P;av++){var aj=a("<tr></tr>");var ae=ap[av].length;for(var ar=0;ar<ae;ar++){var aw=ap[av][ar];var t=ao+1;var w=ah;var E="";var S="";var am=true;if(av==0){if(ap[av][ar]>7){am=false;t=t-1;if(t<=0){t=12;w=w-1}}}if(av==P-1){if(ap[av][ar]<=7){am=false;t=t+1;if(t>=12){t=1;w=w+1}}}if(r.getFullYear()==w&&(r.getMonth()+1)==t&&r.getDate()==aw){E=" today-date ";S="data-title='"+F+"'"}if(h!=null&&h.getFullYear()==w&&(h.getMonth()+1)==t&&h.getDate()==aw){E=" default-date ";S="data-title='"+au+"'"}if(ar==K||ar==M){E+=" holiday "}if(typeof p.notes!=="undefined"){if(q(new Date(w,t-1,aw))){E+=" note "}}var ai="<td id='calendarClick' class='"+E+" "+((am==true)?"calendarClick":"")+"' data-date='"+aw+"' data-month='"+t+"' data-year='"+w+"'><div class='entry' "+S+">"+aw+"</div></td>";if(z!=null){var ag=new Date(w,t-1,aw);if(z>ag){ai="<td class='"+E+"' data-date='"+aw+"' data-month='"+t+"' data-year='"+w+"'><div class='entry' "+S+">"+aw+"</div></td>"}}if(H!=null){var ag=new Date(w,t-1,aw);if(H<ag){ai="<td class='"+E+"' data-date='"+aw+"' data-month='"+t+"' data-year='"+w+"'><div class='entry' "+S+">"+aw+"</div></td>"}}aj.append(ai)}C.append(aj)}var aA="";if(p.showNotes){var aq=j();var W=aq.length;if(W>0){aA=a("<ul class='dncalendar-note-list'></ul>");for(var av=0;av<W;av++){var aw=aq[av].date;var R=aq[av].notes;var N=R.length;var T="";T+="<li class='date'>";T+="<span>"+aw+"</span> ";if(N>0){T+=" : ";for(var ar=0;ar<N;ar++){T+=R[ar];if(N<=ar){T+=", "}}}T+="</li>";aA.append(T)}}}aa.append(x);aa.append(C);L.append(aa);i.html("");i.append(al);i.append(L);i.append(aA)};var q=function(u){var x=p.notes.length;for(var w=0;w<x;w++){var v=p.notes[w].date.split("-");var t=new Date(v[0],v[1]-1,v[2]);if(t.getFullYear()==u.getFullYear()&&t.getMonth()==u.getMonth()&&t.getDate()==u.getDate()){return true}}return false};var j=function(){var u=[];var y=p.notes.length;for(var x=0;x<y;x++){var w=p.notes[x].date.split("-");var t=new Date(w[0],w[1]-1,w[2]);if(t.getFullYear()==f.getFullYear()&&t.getMonth()==f.getMonth()){var v={};v.date=t.getDate();v.notes=p.notes[x].note;u.push(v)}}return u};var b=function(){var t=new Date(f.getFullYear(),f.getMonth()+1,1);var u=t.getDate();var w=t.getMonth();var v=t.getFullYear();f=new Date(v,w,u);g()};var s=function(){var v=new Date(f.getFullYear(),f.getMonth()-1,1);var t=v.getDate();var w=v.getMonth();var u=v.getFullYear();f=new Date(u,w,t);g()};var k=function(){a("body").on("click","#calendarClick",function(){var t=a(this).data("date");var u=a(this).data("month");var v=a(this).data("year");p.dayClick.call(this,new Date(v,u-1,t),i)});a("body").on("click","#dncalendar-prev-month",function(){s()});a("body").on("click","#dncalendar-next-month",function(){b()})};return{build:function(){p=a.extend({},a.fn.dnCalendar.defaults,e);if(typeof p.defaultDate!=="undefined"){var t=p.defaultDate.split("-");f=new Date(t[0],t[1]-1,t[2]);h=f}g();k()},update:function(u){p=a.extend(p,u);if(typeof p.defaultDate!=="undefined"){var t=p.defaultDate.split("-");f=new Date(t[0],t[1]-1,t[2]);h=f}g()}}};a.fn.dnCalendar.defaults={monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayUseShortName:false,monthUseShortName:false,showNotes:false,startWeek:"sunday",dayClick:function(c,b){}}}(jQuery));